<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/ReactNote/blog/rss.xml" title="React Note Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ReactNote/blog/atom.xml" title="React Note Blog Atom Feed"><title data-react-helmet="true">React Note</title><meta data-react-helmet="true" property="og:title" content="React Note"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://BUPTlhuanyu.github.io/ReactNote/docs/react/react/shared"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="description" content="ç›®å½•ç»“æ„"><meta data-react-helmet="true" property="og:description" content="ç›®å½•ç»“æ„"><link data-react-helmet="true" rel="shortcut icon" href="/ReactNote/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://BUPTlhuanyu.github.io/ReactNote/docs/react/react/shared"><link data-react-helmet="true" rel="alternate" href="https://BUPTlhuanyu.github.io/ReactNote/docs/react/react/shared" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://BUPTlhuanyu.github.io/ReactNote/docs/react/react/shared" hreflang="x-default"><link rel="stylesheet" href="/ReactNote/assets/css/styles.694d919f.css">
<link rel="preload" href="/ReactNote/assets/js/runtime~main.a78b756c.js" as="script">
<link rel="preload" href="/ReactNote/assets/js/main.48fd23c8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?64a3c7fa9e8533c72827dc22e0d273ab";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ReactNote/"><img src="/ReactNote/img/logo.png" alt="React Note Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/ReactNote/img/logo.png" alt="React Note Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">React Note</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ReactNote/docs/react/react/intro">React</a><a class="navbar__item navbar__link" href="/ReactNote/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/BUPTlhuanyu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">react</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ReactNote/docs/react/react/intro">ä»‹ç»</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ReactNote/docs/react/react/project-directory">ç›®å½•ç»“æ„</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ReactNote/docs/react/react/shared">å…¬å…±æ–¹æ³•</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ReactElement</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">scheduler</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">reconciler</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">event</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ReactNote/docs/react/react/error/error-handle">å¦‚ä½•å¤„ç†é”™è¯¯</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">react-hook-form</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">react-router</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">react-transition</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1></h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„<a class="hash-link" href="#ç›®å½•ç»“æ„" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">shared</span></span><span class="token-line" style="color:#393A34"><span class="token plain">â€”â€”â€”â€”é”™è¯¯å¤„ç†â€”â€”â€”</span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ invariant.js                 </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯å¤„ç†ï¼šæ ¼å¼åŒ–è¾“å‡ºé”™è¯¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ reactProdInvariant.js        </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯å¤„ç†ï¼šå°è£… invariant</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ lowPriorityWarning.js        </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯å¤„ç†ï¼šå°è£… console.warn</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ warningWithoutStack.js       </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯å¤„ç†ï¼šå°è£… console.error</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ warning.js                   </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯å¤„ç†ï¼šè¾“å‡ºå‘ç”Ÿé”™è¯¯çš„ç»„ä»¶å±‚çº§ä¿¡æ¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ describeComponentFrame.js    </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯å¤„ç†ï¼šé”™è¯¯ä¿¡æ¯æ¥æºäºbabel-transform -react-jsx</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ invokeGuardedCallbackImpl.js </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯å¤„ç†ï¼šæ”¶é›† error</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â€”â€”â€”â€”ReactElementä¸fiberâ€”â€”â€”</span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactElementType.js          </span><span class="token comment" style="color:#999988;font-style:italic">// ReactElement é€šç”¨å±æ€§ç±»å‹å®šä¹‰</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactSymbols.js              </span><span class="token comment" style="color:#999988;font-style:italic">// ReactElement $$typeof å±æ€§å®šä¹‰</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactTypes.js                </span><span class="token comment" style="color:#999988;font-style:italic">// å„ç§ReactElementç±»å‹ï¼ˆ$$typeofï¼‰çš„å±æ€§å®šä¹‰</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactLazyComponent.js        </span><span class="token comment" style="color:#999988;font-style:italic">// ReactLazyComponent å±æ€§å®šä¹‰</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactPortal.js               </span><span class="token comment" style="color:#999988;font-style:italic">// ReactPortal å±æ€§å®šä¹‰</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ isValidElementType.js        </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªReactElement</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactInstanceMap.js          </span><span class="token comment" style="color:#999988;font-style:italic">// æä¾›æ–¹æ³•å°†ReactElementä¸å…¶fiberå…³è”èµ·æ¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactWorkTags.js             </span><span class="token comment" style="color:#999988;font-style:italic">// Fiber.tag å±æ€§å€¼ï¼Œè¡¨ç¤ºè¯¥fiberçš„ç±»å‹ï¼Œå³å¯¹åº”å“ªç§reactå®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ getComponentName.js          </span><span class="token comment" style="color:#999988;font-style:italic">// è·å–ç»„ä»¶åç§°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â€”â€”â€”â€”fiberçš„æ“ä½œâ€”â€”â€”â€”</span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ getParent.js                 </span><span class="token comment" style="color:#999988;font-style:italic">// è·å–çˆ¶fiber</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ getParentInstance.js         </span><span class="token comment" style="color:#999988;font-style:italic">// åŒä¸Šï¼Œå°±æ˜¯æ¢äº†åå­—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ getLowestCommonAncestor.js   </span><span class="token comment" style="color:#999988;font-style:italic">// è·å–æœ€ä½å…¬å…±ç¥–å…ˆ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ isAncestor.js                </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ¤æ–­Aæ˜¯å¦æ˜¯Bçš„ç¥–å®—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ traverseTwoPhase.js          </span><span class="token comment" style="color:#999988;font-style:italic">// æ¨¡æ‹Ÿå†’æ³¡æ•è·</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ traverseEnterLeave.js        </span><span class="token comment" style="color:#999988;font-style:italic">// æ¨¡æ‹Ÿç§»é™¤è¿›å…¥äº‹ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â€”â€”â€”â€”æ ‡è®°éœ€è¦å¯¹fiberæ‰§è¡Œä»€ä¹ˆç±»å‹çš„æ“ä½œâ€”â€”â€”â€”</span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ ReactSideEffectTags.js       </span><span class="token comment" style="color:#999988;font-style:italic">// ç†Ÿæ‚‰çš„æœ‰ Replaceï¼Œdeletion</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â€”â€”â€”â€”æ¯”è¾ƒâ€”â€”â€”â€”</span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ areHookInputsEqual.js        </span><span class="token comment" style="color:#999988;font-style:italic">// æ¯”è¾ƒä¸¤æ•°ç»„æ˜¯ä¸€æ ·ï¼šæ¯”è¾ƒhookä¼ å…¥çš„æ•°ç»„æ˜¯å¦æ˜¯ä¸€æ ·çš„</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ shallowEqual.js              </span><span class="token comment" style="color:#999988;font-style:italic">// æµ…æ¯”è¾ƒï¼šObject.isï¼ŒhasOwnProperty</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">â€”â€”â€”â€”å…¶ä»–ï¼Œå¿½ç•¥â€”â€”â€”â€”</span></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€ *</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†<a class="hash-link" href="#é”™è¯¯å¤„ç†" title="Direct link to heading">#</a></h2><p>â€‹	åœ¨ä½¿ç”¨<code>react</code>çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæŠ¥é”™ï¼Œç»å¸¸ä¼šçœ‹åˆ°æŸä¸ªé”™è¯¯å‘ç”Ÿåœ¨å“ªä¸ªç»„ä»¶æ–‡ä»¶ä¸­ï¼Œè¯¦ç»†åˆ°ç»„ä»¶æ–‡ä»¶çš„è¡Œæ•°ä¸åˆ—æ•°ï¼Œè¿™äº›é”™è¯¯ä¿¡æ¯æŒ‚è½½åœ¨<code>react</code> å®ä¾‹(<code>ReactElement</code>)çš„<code>_source</code>è¿™æ ·çš„å±æ€§ä¸Šï¼Œé”™è¯¯ä¿¡æ¯æ˜¯ç”±<code>babel</code>ç”Ÿäº§çš„ï¼ŒåŸç†æ˜¯ç¼–è¯‘æ—¶<code>babel-transform -react-jsx</code>åœ¨å°† <code>jsx</code>è§£ææˆ<code>createElement</code>è°ƒç”¨å½¢å¼ï¼Œè€Œ<code>createElement</code>æ¥æ”¶åˆ°çš„ç¬¬äºŒä¸ªå‚æ•°åˆ™åŒ…å«äº†<code>_source</code>å±æ€§ï¼Œ<code>createElement</code>åœ¨åé¢ç« èŠ‚ä¼šè®²åˆ°ï¼Œä¸»è¦åˆ›å»ºä¸€ä¸ª<code>react</code> å®ä¾‹ã€‚<code>_source</code>å¦‚ä¸‹ï¼š</p><p><img alt="fiber" src="/ReactNote/assets/images/_source-f7c256a56cc054c9762a5459b3dc35e1.png"></p><p>â€‹	è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œ<code>invokeGuardedCallbackImpl.js</code>ä¼šæ”¶é›†ç”¨æˆ·å¤–éƒ¨å‡½æ•°çš„é”™è¯¯ä¿¡æ¯(<code>Error</code>å®ä¾‹)ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä¸»è¦ç”±<code>try...catch</code>å®ç°ï¼Œåœ¨ <code>try</code>ä¸­ä¼šæ‰§è¡Œæ¶‰åŠç”¨æˆ·ä¼ å…¥å‡½æ•°(<code>user-provided function</code> )çš„å‡½æ•°ï¼Œï¼ˆæ¯”å¦‚<code>workLopp</code>ï¼Œå³ç”¨äºå¾ªç¯åè°ƒç»„ä»¶çš„å‡½æ•°ï¼Œåœ¨åè°ƒè¿‡ç¨‹åˆ™ä¼šæ‰§è¡Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼‰ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeGuardedCallbackImpl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">name</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">func</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">b</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">c</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">d</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">e</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> funcArgs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    func</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> funcArgs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">onError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œåˆ™æ¨¡æ‹Ÿäº†ä¸€ä¸ª <code>try...catch</code>ä»£ç å—ï¼ŒåŸç†æ˜¯æ›¿æ¢æ‰ <code>window</code> ä¸Šçš„ <code>error</code> äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª<code>DOM</code>ï¼Œæ¥ç€è‡ªå®šä¹‰ä¸€ä¸ªäº‹ä»¶å¹¶åœ¨åˆ›å»ºçš„ <code>DOM</code> ä¸Šç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°ï¼ŒåŒæ­¥è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œäº‹ä»¶å¤„ç†å‡½æ•°ä¸­æ‰§è¡ŒåŒ…å«<code>user-provided function</code>çš„ä»£ç ï¼Œå¦‚æœæŠ¥é”™äº†ï¼Œé‚£ä¹ˆ<code> error</code> äº‹ä»¶ç›‘å¬å‡½æ•°ä¼šæ‰§è¡Œï¼Œå¹¶æ”¶é›†é”™è¯¯ã€‚é”™è¯¯ç³»ç»Ÿåœ¨<code>react</code>ä¸­æ˜¯éå¸¸é‡è¦çš„ä¸€å—ï¼Œ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeGuardedCallbackImpl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">name</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">func</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">b</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">c</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">d</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">e</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> evt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Event&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> didError </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">callCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token method function property-access" style="color:#d73a49">func</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> funcArgs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        didError </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> didSetError </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> isCrossOriginError </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handleWindowError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// è®¾ç½®ä¸€ä¸‹ error</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> evtType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">react-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">name </span><span class="token template-string interpolation operator" style="color:#393A34">?</span><span class="token template-string interpolation"> name </span><span class="token template-string interpolation operator" style="color:#393A34">:</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation string" style="color:#e3116c">&#x27;invokeguardedcallback&#x27;</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handleWindowError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      fakeNode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evtType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> callCallback</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      evt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">initEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evtType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      fakeNode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">dispatchEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">evt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">didError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">didSetError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">error </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isCrossOriginError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">error </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;...&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">onError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">removeEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handleWindowError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å¯¹äº<code>react</code>çš„é”™è¯¯å¤„ç†ç³»ç»Ÿï¼Œè¿™é‡Œæš‚æ—¶å¿½ç•¥ï¼Œåç»­ä¼šç­‰ç³»åˆ—ç»“æŸä¹‹åä»¥ä¸€ä¸ªé™„å½•è¡¥å……ï¼Œå½“ç„¶å¦‚æœæœ‰å¥½çš„æ–‡ç« ï¼Œæ¬¢è¿åœ¨è¯„è®ºè´´å‡ºï¼Œç›®å‰å…ˆå›åˆ°ä¸»çº¿ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ç»„ä»¶ç›¸å…³"></a>ç»„ä»¶ç›¸å…³<a class="hash-link" href="#ç»„ä»¶ç›¸å…³" title="Direct link to heading">#</a></h2><blockquote><p>åœ¨å¼€å§‹ä¹‹å‰éœ€è¦æœ‰ä¸€å®šçš„æ¦‚å¿µï¼ŒJSX --&gt; ReactElement --&gt; Fiber --&gt; è§†å›¾ï¼Œreactåœ¨å°†jsxç”Ÿæˆå¯¹åº”çš„ReactElementä¹‹åä¼šæ®æ­¤ç”Ÿæˆä¸€ä¸ªfiberï¼ŒReactElementä¸Šçš„ç”Ÿå‘½å‘¨æœŸé’©å­äº§ç”Ÿçš„æ›´æ–°ä¿®æ”¹çš„æ˜¯è¿™ä¸ªfiberä¸Šçš„æ•°æ®ï¼Œå› æ­¤å¯ä»¥çœ‹å‡ºfiberå…¶å®å¯ä»¥å½“æˆä¸€ä¸ªæ•°æ®å®¹å™¨ï¼Œä¿å­˜äº†è¯¥fiberå½“å‰çš„çŠ¶æ€ï¼Œå½“æŸä¸ªæ—¶é—´ç‚¹fiberçš„æ•°æ®æ›´æ–°å®Œæˆä¹‹åï¼Œreactä¼šå°†è¯¥fiberçš„æ•°æ®æ¸²æŸ“åˆ°è§†å›¾ä¸Šã€‚ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°reactä¸­æ•°æ®çš„åˆ†å±‚ç»“æ„ï¼ŒReactElementæ˜¯æœ€è´´è¿‘å¼€å‘è€…è¿™ä¸€å±‚çš„ï¼Œå¯¹å¤–æ¥å—ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚fiberåˆ™æ˜¯reactåº•å±‚æ•°æ®å®¹å™¨ï¼Œfiberç›´æ¥å½±å“çš„domåˆ™æ˜¯é¡µé¢ç”¨æˆ·ä¾§ã€‚</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="reactelementtypejs"></a>ReactElementType.js<a class="hash-link" href="#reactelementtypejs" title="Direct link to heading">#</a></h3><p>åªåˆ—å‡ºå¼€å‘ç¯å¢ƒå­˜åœ¨çš„å±æ€§ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€äº›éå¸¸ç†Ÿæ‚‰çš„å±æ€§<code>key,ref,props</code>ï¼Œ<code>_owner</code>åˆ™æ˜¯è¯¥ç»„ä»¶æ ‡ç­¾æ‰€åœ¨çš„ç»„ä»¶å¯¹åº”çš„ReactElementã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ <code>type</code> å±æ€§ä»¥åŠ<code>$$typeof</code>ï¼Œåç»­ä¸“é—¨ä»‹ç» <code>createElement</code>å‡½æ•°å¦‚ä½•æ„å»ºä¸€ä¸ª <code>ReactElement</code> ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> type </span><span class="token maybe-class-name">ReactElement</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  $$</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  key</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ref</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  props</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  _owner</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ReactInstance or ReactFiber</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="type"></a>type<a class="hash-link" href="#type" title="Direct link to heading">#</a></h4><blockquote><p><code>type</code> è¡¨ç¤ºçš„æ˜¯è¿™ä¸ª<code>ReactElement</code>çš„è¡Œä¸º</p></blockquote><p>åœ¨è°ƒç”¨ <code>createElement</code> åˆ›å»º <code>ReactElement</code> çš„æ—¶å€™ï¼Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸º <code>type</code> å±æ€§çš„å€¼ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²æ¯”å¦‚<code>&#x27;div&#x27;</code>ï¼Œåˆ™è¡¨ç¤ºè¯¥<code>react</code>å®ä¾‹å¯¹åº”ä¸€ä¸ªçœŸå®çš„<code>dom</code>ï¼›å¦‚æœæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™è¡¨ç¤ºä¸€ä¸ªå‡½æ•°/ç±»ç»„ä»¶ï¼›</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">FnType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;div&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">Content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            f</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            a</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">ClassType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡(<code>typeof  === &#x27;object&#x27;</code>)ï¼Œæ¯”å¦‚ <code>Context.Provider</code>ï¼Œ<code>Context.Consumer</code>ï¼Œ<code>React.lazy</code>ï¼Œ<code>React.forwardRef</code>ï¼Œ<code>React.memo</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Context.Provider</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  $$</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Symbol</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">react</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  _context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    $$</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Symbol</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">react</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Consumer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">$$</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Symbol</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">react</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">â€¦</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _calculateChangedBits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> â€¦</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Provider</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">$$</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Symbol</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">react</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">â€¦</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="typeof"></a>$$typeof<a class="hash-link" href="#typeof" title="Direct link to heading">#</a></h4><blockquote><p><code>$$typeof</code> è¡¨ç¤ºçš„æ˜¯è¿™ä¸ª<code>ReactElement</code>çš„ç±»å‹</p></blockquote><p>å¯¹äº <code>$$typeof</code>ï¼Œåœ¨<code>ReactSymbols.js</code>ä¸­å¯ä»¥æ‰¾åˆ°å…¶å€¼ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_ELEMENT_TYPE = hasSymbol ? Symbol.for(&#x27;react.element&#x27;): 0xeac7;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_PORTAL_TYPE = hasSymbol? Symbol.for(&#x27;react.portal&#x27;): 0xeaca;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_FRAGMENT_TYPE = hasSymbol? Symbol.for(&#x27;react.fragment&#x27;): 0xeacb;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_STRICT_MODE_TYPE = hasSymbol? Symbol.for(&#x27;react.strict_mode&#x27;): 0xeacc;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_PROFILER_TYPE = hasSymbol? Symbol.for(&#x27;react.profiler&#x27;): 0xead2;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_PROVIDER_TYPE = hasSymbol? Symbol.for(&#x27;react.provider&#x27;): 0xeacd;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_CONTEXT_TYPE = hasSymbol? Symbol.for(&#x27;react.context&#x27;): 0xeace;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_ASYNC_MODE_TYPE = hasSymbol? Symbol.for(&#x27;react.async_mode&#x27;): 0xeacf;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_CONCURRENT_MODE_TYPE = hasSymbol? Symbol.for(&#x27;react.concurrent_mode&#x27;): 0xeacf;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_FORWARD_REF_TYPE = hasSymbol? Symbol.for(&#x27;react.forward_ref&#x27;): 0xead0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_SUSPENSE_TYPE = hasSymbol? Symbol.for(&#x27;react.suspense&#x27;): 0xead1;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_MEMO_TYPE = hasSymbol ? Symbol.for(&#x27;react.memo&#x27;) : 0xead3;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">export const REACT_LAZY_TYPE = hasSymbol ? Symbol.for(&#x27;react.lazy&#x27;) : 0xead4;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="reactinstancemapjs"></a>ReactInstanceMap.js<a class="hash-link" href="#reactinstancemapjs" title="Direct link to heading">#</a></h3><p>æä¾›æ–¹æ³•å°†<code>ReactElement</code>ä¸å…¶<code>fiber</code>å…³è”èµ·æ¥ï¼Œæ¯”å¦‚ç»™ç»„ä»¶å®ä¾‹çš„ <code>_reactInternalFiber</code> å±æ€§ <code>remove/get/has/set</code> ç»„ä»¶å®ä¾‹å¯¹åº”çš„ fiber å¯¹è±¡ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="reactworktagsjs"></a>ReactWorkTags.js<a class="hash-link" href="#reactworktagsjs" title="Direct link to heading">#</a></h3><p><code>Fiber.tag</code> å±æ€§å€¼ï¼Œè¡¨ç¤ºè¯¥<code>fiber</code>çš„ç±»å‹ï¼Œå³å¯¹åº”å“ªç§<code>react</code>å®ä¾‹ï¼Œæ¯”å¦‚<code> fiber.tag</code> ä¸º <code>0</code> è¡¨ç¤ºè¯¥ <code>fiber</code> å¯¹åº”çš„ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="æ ‡è®°éœ€è¦å¯¹fiberæ‰§è¡Œä»€ä¹ˆç±»å‹çš„æ“ä½œ"></a>æ ‡è®°éœ€è¦å¯¹fiberæ‰§è¡Œä»€ä¹ˆç±»å‹çš„æ“ä½œ<a class="hash-link" href="#æ ‡è®°éœ€è¦å¯¹fiberæ‰§è¡Œä»€ä¹ˆç±»å‹çš„æ“ä½œ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="reactsideeffecttagsjs"></a>ReactSideEffectTags.js<a class="hash-link" href="#reactsideeffecttagsjs" title="Direct link to heading">#</a></h3><p>å¯¹<code>fiber</code>éœ€è¦è¿›è¡Œä»€ä¹ˆæ“ä½œçš„æ ‡å¿—</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">NoEffect</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*              */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// è¿™ä¸ªfiberå•¥éƒ½ä¸è¦å¹²</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">PerformedWork</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*         */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000000001</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// react devtoolsç›¸å…³çš„ï¼Œå¿½ç•¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// You can change the rest (and add more).</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Placement</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*             */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000000010</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// è¡¨ç¤ºdoméœ€è¦æ›¿æ¢</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Update</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*                */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000000100</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// è¡¨ç¤ºdoméœ€è¦æ›´æ–°å±æ€§</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">PlacementAndUpdate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*    */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000000110</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ›¿æ¢ä»¥åŠæ›´æ–°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Deletion</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*              */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000001000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// doméœ€è¦åˆ é™¤</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">ContentReset</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*          */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000010000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// domçš„æ–‡æœ¬å†…å®¹éœ€è¦é‡ç½®</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Callback</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*              */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000000100000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// setStateæœ‰å›è°ƒè¦æ‰§è¡Œ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">DidCapture</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*            */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000001000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æœ‰ç»„ä»¶suspendedï¼Œéœ€è¦æŒ‚åœ¨å¯¹åº”çš„ç»„ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Ref</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*                   */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000010000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// éœ€è¦æ›´æ–° ref</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Snapshot</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*              */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b000100000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// è¡¨ç¤ºåœ¨æ¸²æŸ“domä¹‹å‰éœ€è¦æ‰§è¡ŒgetSnapshotBeforeUpdate</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Passive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*               */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b001000000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å‰¯ä½œç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Passive &amp; Update &amp; Callback &amp; Ref &amp; Snapshot</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">LifecycleEffectMask</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*   */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b001110100100</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Union of all host effects</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">HostEffectMask</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*        */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b001111111111</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Incomplete</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*            */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b010000000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å‘ç”Ÿé”™è¯¯ä¸­æ–­äº†ï¼Œç»„ä»¶è¿˜æ²¡åè°ƒå®Œçš„æ ‡è®°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">ShouldCapture</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*         */</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0b100000000000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å›æ»šä½¿suspendç»„ä»¶å¤„äºåˆå§‹çŠ¶æ€ï¼Œå¸è½½fallbackç»„ä»¶</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="fiber-çš„æ“ä½œ"></a>fiber çš„æ“ä½œ<a class="hash-link" href="#fiber-çš„æ“ä½œ" title="Direct link to heading">#</a></h2><blockquote><p>Fiber.return è¡¨ç¤ºè¯¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</p><p>Ifber.alternate è¡¨ç¤ºå½“å‰fiberå¯¹åº”çš„è€çš„fiberèŠ‚ç‚¹ï¼Œè¿™é‡Œè®¾è®¡åŒç¼“å†²fiberæ ‘ï¼Œæš‚ä¸ä»‹ç»</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="getparent"></a>getParent<a class="hash-link" href="#getparent" title="Direct link to heading">#</a></h4><p>åœ¨<code>fiber</code>æ ‘ä¸­è·å–å½“å‰å®ä¾‹èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å®ä¾‹ï¼ˆè¯¥çˆ¶èŠ‚ç‚¹å¯¹åº”çš„åªèƒ½æ˜¯çœŸå®<code>DOM</code>ï¼Œä¸èƒ½æ˜¯<code>text</code>æˆ–è€…ç±»ç»„ä»¶æˆ–è€…å‡½æ•°ç»„ä»¶ç­‰ç­‰ï¼‰ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">//HostComponentç»„ä»¶å¯¹åº”çš„DOMï¼Œæ¯”å¦‚Appçš„tag=3, è¡¨ç¤ºä¸ºç±»ç»„ä»¶ï¼Œå…¶childä¸ºtag=5å¯¹åº”divå…ƒç´ ã€‚</span></span><span class="token-line" style="color:#393A34"><span class="token plain">function getParent(inst) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  do {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    inst = inst.return;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  } while (inst &amp;&amp; inst.tag !== HostComponent);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (inst) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return inst;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return null;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="getlowestcommonancestor"></a>getLowestCommonAncestor<a class="hash-link" href="#getlowestcommonancestor" title="Direct link to heading">#</a></h4><p>è·å–èŠ‚ç‚¹<code>A</code>ä¸<code>B</code>çš„æœ€è¿‘çš„å…¬å…±ç¥–å…ˆèŠ‚ç‚¹</p><p>ç®€å•ç®—æ³•é¢˜ï¼šæ‰¾åˆ°ä¸¤ä¸ªé“¾è¡¨çš„å…¬å…±èŠ‚ç‚¹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export function getLowestCommonAncestor(instA, instB) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //è·å–å­èŠ‚ç‚¹Aåœ¨æ ‘ä¸­çš„æ·±åº¦</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  let depthA = 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let tempA = instA; tempA; tempA = getParent(tempA)) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    depthA++;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //è·å–å­èŠ‚ç‚¹Båœ¨æ ‘ä¸­çš„æ·±åº¦</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  let depthB = 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let tempB = instB; tempB; tempB = getParent(tempB)) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    depthB++;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  // If A is deeper, crawl up.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  // å¦‚æœAçš„æ·±åº¦é«˜ï¼Œé‚£ä¹ˆAèŠ‚ç‚¹å…ˆå¾€ä¸Šèµ°depthA - depthBä¸ªèŠ‚ç‚¹ï¼Œæœ€ååŒæ—¶èµ°ï¼Œç›´åˆ°çˆ¶èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ª</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (depthA - depthB &gt; 0) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    instA = getParent(instA);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    depthA--;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¦‚æœBçš„æ·±åº¦é«˜ï¼Œé‚£ä¹ˆBèŠ‚ç‚¹å…ˆå¾€ä¸Šèµ°depthB - depthBä¸ªèŠ‚ç‚¹ï¼Œæœ€ååŒæ—¶èµ°ï¼Œç›´åˆ°çˆ¶èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ª</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  // If B is deeper, crawl up.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (depthB - depthA &gt; 0) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    instB = getParent(instB);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    depthB--;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Walk in lockstep until we find a match.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  // ç°åœ¨ï¼ŒæŒ‡é’ˆæ‰€å¤„çš„ä½ç½®çš„é«˜åº¦ä¸€è‡´ï¼Œå¯ä»¥åŒæ—¶å¾€ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å…¬å…±çš„èŠ‚ç‚¹</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  let depth = depthA;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (depth--) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (instA === instB || instA === instB.alternate) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      return instA;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    instA = getParent(instA);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    instB = getParent(instB);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return null;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="isancestor"></a>isAncestor<a class="hash-link" href="#isancestor" title="Direct link to heading">#</a></h4><p>åˆ¤æ–­<code>A</code>èŠ‚ç‚¹æ˜¯å¦æ˜¯<code>B</code>èŠ‚ç‚¹çš„ç¥–å…ˆèŠ‚ç‚¹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export function isAncestor(instA, instB) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (instB) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (instA === instB || instA === instB.alternate) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    instB = getParent(instB);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="getparentinstance"></a>getParentInstance<a class="hash-link" href="#getparentinstance" title="Direct link to heading">#</a></h4><p>å¯¹<code>getParent</code>çš„<code>export</code>å°è£…ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export function getParentInstance(inst) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return getParent(inst);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="traversetwophase"></a>traverseTwoPhase<a class="hash-link" href="#traversetwophase" title="Direct link to heading">#</a></h4><p>å¯¹<code>fiber</code>åŠå…¶ä»¥ä¸Šçš„æ ‘æ‰§è¡Œå†’æ³¡æ•è·çš„æ“ä½œï¼Œæ‰§è¡Œ<code>fn</code>ã€‚ç±»ä¼¼äº‹ä»¶çš„å†’æ³¡æ•è·</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export function traverseTwoPhase(inst, fn, arg) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  const path = [];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //å°†instçš„çˆ¶èŠ‚ç‚¹å…¥æ ˆï¼Œæ•°ç»„æœ€åçš„ä¸ºæœ€è¿œçš„ç¥–å…ˆ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (inst) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    path.push(inst);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    inst = getParent(inst);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  let i;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //ä»æœ€è¿œçš„ç¥–å…ˆå¼€å§‹å‘instèŠ‚ç‚¹æ•è·æ‰§è¡Œfn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (i = path.length; i-- &gt; 0; ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn(path[i], &#x27;captured&#x27;, arg);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //ä»instèŠ‚ç‚¹å¼€å§‹å‘æœ€è¿œçš„ç¥–å…ˆèŠ‚ç‚¹å†’æ³¡æ‰§è¡Œfn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (i = 0; i &lt; path.length; i++) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn(path[i], &#x27;bubbled&#x27;, arg);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="traverseenterleave"></a>traverseEnterLeave<a class="hash-link" href="#traverseenterleave" title="Direct link to heading">#</a></h4><p>å½“å…³æ³¨ç‚¹ä»<code>from</code>èŠ‚ç‚¹ç§»å‡ºç„¶åç§»å…¥<code>to</code>èŠ‚ç‚¹çš„æ—¶å€™,åœ¨<code>from</code>æ‰§è¡Œæ‰§è¡Œç±»ä¼¼ç§»å…¥ç§»å‡ºçš„æ“ä½œ</p><p><code>Fiber</code> æ ‘å¦‚ä¸‹å¦‚ä¸‹ï¼š</p><p><img alt="fiber" src="data:image/png;base64,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"></p><p>ä¸Šè¿°è¿‡ç¨‹ï¼Œå½“æ‰§è¡Œ<code>traverseEnterLeave(E, B, fn, argFrom, argTo)</code>å‡½æ•°çš„æ—¶å€™ï¼Œç±»ä¼¼é¼ æ ‡ä»èŠ‚ç‚¹<code>from</code>(å³EèŠ‚ç‚¹)ç§»å…¥åˆ°èŠ‚ç‚¹<code>to</code>(å³BèŠ‚ç‚¹)ï¼Œè¿™ä¸ªæ—¶å€™ä¼šä¾æ¬¡è°ƒç”¨</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fn(E, &#x27;bubbled&#x27;, argFrom) --&gt; fn(C, &#x27;bubbled&#x27;, argFrom) --&gt; fn(B, &#x27;captured&#x27;, argTo)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™æ ·çš„ä¸€ä¸ªè¿‡ç¨‹æ˜¯ä»èŠ‚ç‚¹<code>E</code>å†’æ³¡åˆ°æœ€ä½å…¬å…±ç¥–å…ˆèŠ‚ç‚¹<code>A</code>ç„¶åå‘ä¸‹æ•è·ç›´åˆ°èŠ‚ç‚¹<code>B</code>ã€‚è¿‡ç¨‹ä¸­ä¼šä¾æ¬¡è°ƒç”¨<code>fn</code>ã€‚ä½†æ˜¯ä¸ä¼šå¯¹æœ€ä½å…¬å…±ç¥–å…ˆèŠ‚ç‚¹æ‰§è¡Œ<code>fn</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export function traverseEnterLeave(from, to, fn, argFrom, argTo) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  const common = from &amp;&amp; to ? getLowestCommonAncestor(from, to) : null;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  const pathFrom = [];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (true) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!from) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (from === common) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    const alternate = from.alternate;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (alternate !== null &amp;&amp; alternate === common) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    pathFrom.push(from);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    from = getParent(from);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  const pathTo = [];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (true) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!to) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (to === common) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    const alternate = to.alternate;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (alternate !== null &amp;&amp; alternate === common) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      break;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    pathTo.push(to);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    to = getParent(to);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //ä»¥ä¸Šä»£ç å°†fromèŠ‚ç‚¹åˆ°fromä¸toèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ï¼ˆä¸åŒ…æ‹¬å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ï¼‰pushåˆ°pathFromæ•°ç»„</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //ä»¥ä¸Šä»£ç å°†toèŠ‚ç‚¹åˆ°fromä¸toèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ï¼ˆä¸åŒ…æ‹¬å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ï¼‰pushåˆ°pathToæ•°ç»„</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  // ä»¥ä¸‹ä»£ç ç”¨äºå¯¹pathFromå†’æ³¡ï¼Œæ‰§è¡Œfn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 0; i &lt; pathFrom.length; i++) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn(pathFrom[i], &#x27;bubbled&#x27;, argFrom);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä»¥ä¸‹ä»£ç ç”¨äºå¯¹pathToæ•è·ï¼Œæ‰§è¡Œfn</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = pathTo.length; i-- &gt; 0; ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn(pathTo[i], &#x27;captured&#x27;, argTo);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="æ¯”è¾ƒ"></a>æ¯”è¾ƒ<a class="hash-link" href="#æ¯”è¾ƒ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="shallowequaljs"></a>shallowEqual.js<a class="hash-link" href="#shallowequaljs" title="Direct link to heading">#</a></h3><p>æµ…æ¯”è¾ƒ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">const hasOwnProperty = Object.prototype.hasOwnProperty;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">function shallowEqual(objA: mixed, objB: mixed): boolean {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (is(objA, objB)) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      // ä¸¤ä¸ªå€¼éƒ½æ˜¯ undefined</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      // ä¸¤ä¸ªå€¼éƒ½æ˜¯ null</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      // ä¸¤ä¸ªå€¼éƒ½æ˜¯ true æˆ–è€…éƒ½æ˜¯ false</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      // ä¸¤ä¸ªå€¼æ˜¯ç”±ç›¸åŒä¸ªæ•°çš„å­—ç¬¦æŒ‰ç…§ç›¸åŒçš„é¡ºåºç»„æˆçš„å­—ç¬¦ä¸²</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      // ä¸¤ä¸ªå€¼æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      // ä¸¤ä¸ªå€¼éƒ½æ˜¯æ•°å­—å¹¶ä¸”</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // éƒ½æ˜¯æ­£é›¶ +0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // éƒ½æ˜¯è´Ÿé›¶ -0</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // éƒ½æ˜¯ NaN</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // éƒ½æ˜¯é™¤é›¶å’Œ NaN å¤–çš„å…¶å®ƒåŒä¸€ä¸ªæ•°å­—</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    typeof objA !== &#x27;object&#x27; || objA === null || typeof objB !== &#x27;object&#x27; ||objB === null</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //objAä¸objBæœ‰ä¸€ä¸ªä¸æ˜¯å¯¹è±¡æˆ–è€…æœ‰ä¸€ä¸ªæ˜¯nullï¼Œåˆ™è¿”å›ä¸ç›¸ç­‰ã€‚</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¤„ç†ä¸¤ä¸ªå¯¹è±¡çš„æƒ…å†µ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  const keysA = Object.keys(objA);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  const keysB = Object.keys(objB);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (keysA.length !== keysB.length) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Test for A&#x27;s keys different from B.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 0; i &lt; keysA.length; i++) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      !hasOwnProperty.call(objB, keysA[i]) ||</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      !is(objA[keysA[i]], objB[keysA[i]])</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      return false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return true;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="arehookinputsequaljs"></a>areHookInputsEqual.js<a class="hash-link" href="#arehookinputsequaljs" title="Direct link to heading">#</a></h3><p><code>areHookInputsEqual</code>åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸ç­‰ï¼ŒåŸºäº<code> Object.is</code>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>â€‹	æœ¬èŠ‚ç®€å•çš„ä»‹ç»äº†react ä¸­è¿›è¡Œé”™è¯¯å¤„ç†çš„ä¸€äº›å·¥å…·å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—æ·±ç©¶çš„é—®é¢˜ï¼Œä½†æ˜¯ä¸æ˜¯ä½œä¸ºæœ¬ç« çš„å†…å®¹ï¼Œé‰´äºç›®å‰æ²¡æ‰¾åˆ°ç›¸å…³å†™<code>react error system</code> çš„æ–‡ç« ï¼Œè¿™ä¸€éƒ¨åˆ†æ”¾åˆ°ç³»åˆ—ç»“æŸå†æ¥è®²ã€‚å…¶æ¬¡ç®€å•ä»‹ç»äº†<code>ReactElement</code>çš„æ•°æ®ç»“æ„ï¼Œå¹¶è¯¦ç»†çš„ä»‹ç»äº†ä¸¤ä¸ªå±æ€§<code>type</code>ä»¥åŠ<code>$$typeof</code>ï¼Œå‰è€…ä¸º<code>ReactElement</code>å…·ä½“çš„è¡Œä¸ºï¼Œåè€…ä¸º<code>ReactElement</code>çš„ç±»å‹ã€‚å…¶æ¬¡ä»‹ç»äº†<code>ReactElement</code>ä¸<code>fiber</code>æ˜¯å¦‚ä½•å…³è”èµ·æ¥çš„ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»‹ç»åè€…çš„æ•°æ®ç»“æ„ï¼Œä»¥åŠä¸¤è€…ä¹‹é—´æ˜¯å¦‚ä½•çš„å…³ç³»ï¼Œåç»­ç« èŠ‚ä¼šè¯´åˆ°ï¼Œè¿™é‡Œåªéœ€è¦è®°ä½åè€…çš„&#x27;åŸæ–™&#x27;æ˜¯å‰è€…ï¼Œå‰è€…è´´è¿‘<code>react</code>å¼€å‘è€…ï¼Œåè€…æ˜¯å‰è€…çš„çŠ¶æ€æ•°æ®å®¹å™¨ï¼Œç›´æ¥å½±å“è¡¨ç°å±‚(<code>view</code>)çš„<code>dom</code>ã€‚ç„¶åè¿˜ä»‹ç»äº†<code>fiber</code>çš„ä¸€äº›æ“ä½œï¼Œå…¶å®è¿™äº›æ“ä½œå¯ä»¥çœ‹æˆä¸€ä¸ªäº‹ä»¶ç³»ç»Ÿçš„å¿…å¤‡å‡½æ•°ã€‚æ¥ç€ä»‹ç»äº†<code>react</code>å¦‚ä½•å¯¹<code>fiber</code>æ“ä½œçš„ä¸€äº›æ ‡è®°ã€‚æœ€åä»‹ç»äº†ä¸€äº›æ¯”è¾ƒçš„æ–¹æ³•ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="è¯¾åç»ƒä¹ "></a>è¯¾åç»ƒä¹ <a class="hash-link" href="#è¯¾åç»ƒä¹ " title="Direct link to heading">#</a></h2><p>å¦‚ä½•å®ç°ä¸€ä¸ªäº‹ä»¶ç³»ç»Ÿï¼Ÿ</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/BUPTlhuanyu/ReactNote/tree/master/docs/react/react/shared/shared.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ReactNote/docs/react/react/project-directory"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« ç›®å½•ç»“æ„</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ReactNote/docs/react/react/ReactElement/reactelement-and-children"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ReactElementä»¥åŠChildren Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç›®å½•ç»“æ„" class="table-of-contents__link">ç›®å½•ç»“æ„</a></li><li><a href="#é”™è¯¯å¤„ç†" class="table-of-contents__link">é”™è¯¯å¤„ç†</a></li><li><a href="#ç»„ä»¶ç›¸å…³" class="table-of-contents__link">ç»„ä»¶ç›¸å…³</a><ul><li><a href="#reactelementtypejs" class="table-of-contents__link">ReactElementType.js</a></li><li><a href="#reactinstancemapjs" class="table-of-contents__link">ReactInstanceMap.js</a></li><li><a href="#reactworktagsjs" class="table-of-contents__link">ReactWorkTags.js</a></li></ul></li><li><a href="#æ ‡è®°éœ€è¦å¯¹fiberæ‰§è¡Œä»€ä¹ˆç±»å‹çš„æ“ä½œ" class="table-of-contents__link">æ ‡è®°éœ€è¦å¯¹fiberæ‰§è¡Œä»€ä¹ˆç±»å‹çš„æ“ä½œ</a><ul><li><a href="#reactsideeffecttagsjs" class="table-of-contents__link">ReactSideEffectTags.js</a></li></ul></li><li><a href="#fiber-çš„æ“ä½œ" class="table-of-contents__link">fiber çš„æ“ä½œ</a></li><li><a href="#æ¯”è¾ƒ" class="table-of-contents__link">æ¯”è¾ƒ</a><ul><li><a href="#shallowequaljs" class="table-of-contents__link">shallowEqual.js</a></li><li><a href="#arehookinputsequaljs" class="table-of-contents__link">areHookInputsEqual.js</a></li></ul></li><li><a href="#æ€»ç»“" class="table-of-contents__link">æ€»ç»“</a></li><li><a href="#è¯¾åç»ƒä¹ " class="table-of-contents__link">è¯¾åç»ƒä¹ </a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 BUPTlhuanyu, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/ReactNote/assets/js/runtime~main.a78b756c.js"></script>
<script src="/ReactNote/assets/js/main.48fd23c8.js"></script>
</body>
</html>