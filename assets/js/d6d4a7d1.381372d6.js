"use strict";(self.webpackChunkreact_note_docusaurus=self.webpackChunkreact_note_docusaurus||[]).push([[4214],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return d}});var r=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var c=r.createContext({}),i=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},s=function(e){var n=i(e.components);return r.createElement(c.Provider,{value:n},e.children)},f={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,o=e.originalType,c=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),u=i(t),d=l,y=u["".concat(c,".").concat(d)]||u[d]||f[d]||o;return t?r.createElement(y,a(a({ref:n},s),{},{components:t})):r.createElement(y,a({ref:n},s))}));function d(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var o=t.length,a=new Array(o);a[0]=u;var p={};for(var c in n)hasOwnProperty.call(n,c)&&(p[c]=n[c]);p.originalType=e,p.mdxType="string"==typeof e?e:l,a[1]=p;for(var i=2;i<o;i++)a[i]=t[i];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},2558:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return p},metadata:function(){return i},toc:function(){return f}});var r=t(3117),l=t(102),o=(t(7294),t(3905)),a=["components"],p={id:"react-element",sidebar_label:"ReactElement",slug:"/react/react/ReactElement/others/react-element",sidebar_position:5,title:""},c=void 0,i={unversionedId:"react/react/ReactElement/others/react-element",id:"react/react/ReactElement/others/react-element",title:"",description:"\u603b\u89c8\uff1a",source:"@site/docs/react/react/ReactElement/others/ReactElement.md",sourceDirName:"react/react/ReactElement/others",slug:"/react/react/ReactElement/others/react-element",permalink:"/ReactNote/docs/react/react/ReactElement/others/react-element",editUrl:"https://github.com/BUPTlhuanyu/ReactNote/tree/master/docs/react/react/ReactElement/others/ReactElement.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{id:"react-element",sidebar_label:"ReactElement",slug:"/react/react/ReactElement/others/react-element",sidebar_position:5,title:""},sidebar:"react",previous:{title:"ReactDebugCurrentFrame",permalink:"/ReactNote/docs/react/react/ReactElement/others/react-debug-current-frame"},next:{title:"ReactElementValidator",permalink:"/ReactNote/docs/react/react/ReactElement/others/react-element-validator"}},s={},f=[{value:"\u603b\u89c8\uff1a",id:"\u603b\u89c8",level:3},{value:"hasValidRef",id:"hasvalidref",level:3},{value:"hasValidKey",id:"hasvalidkey",level:3},{value:"defineKeyPropWarningGetter",id:"definekeypropwarninggetter",level:3},{value:"defineRefPropWarningGetter",id:"definerefpropwarninggetter",level:3},{value:"ReactElement",id:"reactelement",level:3},{value:"createElement",id:"createelement",level:3},{value:"\u4ec5\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u83b7\u53d6props\u4e2d\u7684ref\u4e0ekey\u4f1a\u629b\u51fa\u9519\u8bef",id:"\u4ec5\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u83b7\u53d6props\u4e2d\u7684ref\u4e0ekey\u4f1a\u629b\u51fa\u9519\u8bef",level:4},{value:"\u53c2\u6570\u4e2d\u7684children\u8986\u76d6\u987a\u5e8f",id:"\u53c2\u6570\u4e2d\u7684children\u8986\u76d6\u987a\u5e8f",level:4},{value:"\u8fd4\u56de\u503c\u7684\u4f7f\u7528\uff1a\u5982{FooterEnhance}\u3002\u4e0d\u80fd\u5f53\u505a\u666e\u901a\u7ec4\u4ef6\u4f7f\u7528\u3002",id:"\u8fd4\u56de\u503c\u7684\u4f7f\u7528\u5982footerenhance\u4e0d\u80fd\u5f53\u505a\u666e\u901a\u7ec4\u4ef6\u4f7f\u7528",level:4},{value:"\u6e90\u7801",id:"\u6e90\u7801",level:4},{value:"createFactory",id:"createfactory",level:3},{value:"cloneAndReplaceKey",id:"cloneandreplacekey",level:3},{value:"isValidElement",id:"isvalidelement",level:3},{value:"cloneElement",id:"cloneelement",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:3}],u={toc:f};function d(e){var n=e.components,t=(0,l.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"\u603b\u89c8"},"\u603b\u89c8\uff1a"),(0,o.kt)("p",null,"\u4f60\u5c06\u4f1a\u660e\u767d\uff1a\n\u5f00\u53d1\u73af\u5883\u4e0b\uff0ckey\u548cref\u4f1a\u5b58\u5728\u4e8ereact\u5143\u7d20\u7684props\u4e0a\uff0c\u4f46\u662f\u83b7\u53d6\u5230\u7684\u503c\u4e3aundefined\uff0c\u5e76\u62a5\u9519\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e0b\uff0ckey\u548cref\u4e0d\u4f1a\u5b58\u5728\u4e8ereact\u5143\u7d20\u7684props\u4e0a\u7684\u3002\nreact\u7ec4\u4ef6\u4e0a\u7684\u4f20\u9012\u7684key\u4e0eref\u53c2\u6570\u503c\u4e0d\u4f1a\u88abprops\u4f20\u9012\u7ed9\u5176\u4ed6\u7ec4\u4ef6\uff0c\u5f00\u53d1\u73af\u5883\u4e0b\u4e0e\u751f\u4ea7\u73af\u5883\u4e0b\u5904\u7406key\u548cref\u7684\u533a\u522b\uff1f\n..."),(0,o.kt)("hr",null),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u5185\u90e8\u65b9\u6cd5")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\u2502   \u251c\u2500\u2500 hasValidRef ----------------------------- \u68c0\u6d4b\u83b7\u53d6config\u4e0a\u7684ref\u662f\u5426\u5408\u6cd5\n\u2502   \u251c\u2500\u2500 hasValidKey ----------------------------- \u68c0\u6d4b\u83b7\u53d6config\u4e0a\u7684key\u662f\u5426\u5408\u6cd5\n\u2502   \u251c\u2500\u2500 defineKeyPropWarningGetter ----- \u9501\u5b9aprops.key\u7684\u503c\u4f7f\u5f97\u65e0\u6cd5\u83b7\u53d6props.key\n\u2502   \u251c\u2500\u2500 defineRefPropWarningGetter ----- \u9501\u5b9aprops.ref\u7684\u503c\u4f7f\u5f97\u65e0\u6cd5\u83b7\u53d6props.ref\n\u2502   \u251c\u2500\u2500 ReactElement ------------ \u88abcreateElement\u51fd\u6570\u8c03\u7528\uff0c\u6839\u636e\u73af\u5883\u8bbe\u7f6e\u5bf9\u5e94\u7684\u5c5e\u6027\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u5411\u5916\u66b4\u9732\u7684\u51fd\u6570")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\u2502   \u251c\u2500\u2500 createElement ---------------------------- \u751f\u6210react\u5143\u7d20\uff0c\u5bf9\u5176props\u6539\u9020\n\u2502   \u251c\u2500\u2500 createFactory -------------------------------------- react\u5143\u7d20\u5de5\u5382\u51fd\u6570\n\u2502   \u251c\u2500\u2500 cloneAndReplaceKey ---------------------------- \u514b\u9686react\u5143\u7d20\uff0c\u66ff\u6362key\n\u2502   \u251c\u2500\u2500 cloneElement ----------------------------- \u514b\u9686react\u5143\u7d20\uff0c\u5bf9\u5176props\u6539\u9020\n\u2502   \u251c\u2500\u2500 isValidElement ---------------------------------\u5224\u65ad\u5143\u7d20\u662f\u5426\u662freact\u5143\u7d20 \n")),(0,o.kt)("hr",null),(0,o.kt)("h3",{id:"hasvalidref"},"hasValidRef"),(0,o.kt)("p",null,"\u901a\u8fc7Ref\u5c5e\u6027\u7684\u53d6\u503c\u5668\u5bf9\u8c61\u7684isReactWarning\u5c5e\u6027\u68c0\u6d4b\u662f\u5426\u542b\u6709\u5408\u6cd5\u7684Ref\uff0c\u5728\u5f00\u53d1\u73af\u5883\u4e0b\uff0c\u5982\u679c\u8fd9\u4e2aprops\u662freact\u5143\u7d20\u7684props\u90a3\u4e48\u83b7\u53d6\u4e0a\u9762\u7684ref\u5c31\u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u56e0\u4e3a\u5728creatElement\u7684\u65f6\u5019\u5df2\u7ecf\u8c03\u7528\u4e86defineRefPropWarningGetter\u3002\u751f\u4ea7\u73af\u5883\u4e0b\u5982\u679cconfig.ref !== undefined\uff0c\u8bf4\u660e\u5408\u6cd5\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"function hasValidRef(config) {\n  //\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\n  if (__DEV__) {\n    //config\u8c03\u7528Object.prototype.hasOwnProperty\u65b9\u6cd5\u67e5\u770b\u5176\u5bf9\u8c61\u81ea\u8eab\u662f\u5426\u542b\u6709'ref'\u5c5e\u6027\n    if (hasOwnProperty.call(config, 'ref')) {\n      //\u83b7\u53d6\u2018ref\u2019\u5c5e\u6027\u7684\u63cf\u8ff0\u5bf9\u8c61\u7684\u53d6\u503c\u5668\n      const getter = Object.getOwnPropertyDescriptor(config, 'ref').get;\n      //\u5982\u679c\u53d6\u503c\u5668\u5b58\u5728\uff0c\u5e76\u4e14\u53d6\u503c\u5668\u4e0a\u7684isReactWarning\u4e3atrue\uff0c\u5c31\u8bf4\u660e\u6709\u9519\u8bef\uff0c\u8fd4\u56defalse\uff0cref\u4e0d\u5408\u6cd5\n      if (getter && getter.isReactWarning) {\n        return false;\n      }\n    }\n  }\n  //\u5728\u751f\u4ea7\u73af\u5883\u4e0b\u5982\u679cconfig.ref !== undefined\uff0c\u8bf4\u660e\u5408\u6cd5;\n  return config.ref !== undefined;\n}\n")),(0,o.kt)("h3",{id:"hasvalidkey"},"hasValidKey"),(0,o.kt)("p",null,"\u901a\u8fc7key\u5c5e\u6027\u7684\u53d6\u503c\u5668\u5bf9\u8c61\u7684isReactWarning\u5c5e\u6027\u68c0\u6d4b\u662f\u5426\u542b\u6709\u5408\u6cd5\u7684key\uff0c\u4e5f\u5c31\u662f\u5982\u679c\u8fd9\u4e2aprops\u662freact\u5143\u7d20\u7684props\u90a3\u4e48\u4e0a\u9762\u7684key\u5c31\u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u56e0\u4e3a\u5728creatElement\u7684\u65f6\u5019\u5df2\u7ecf\u8c03\u7528\u4e86defineKeyPropWarningGetter\u3002\u903b\u8f91\u4e0e\u4e0a\u540c"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"function hasValidKey(config) {\n  if (__DEV__) {\n    if (hasOwnProperty.call(config, 'key')) {\n      const getter = Object.getOwnPropertyDescriptor(config, 'key').get;\n      if (getter && getter.isReactWarning) {\n        return false;\n      }\n    }\n  }\n  return config.key !== undefined;\n}\n")),(0,o.kt)("h3",{id:"definekeypropwarninggetter"},"defineKeyPropWarningGetter"),(0,o.kt)("p",null,"\u5f00\u53d1\u6a21\u5f0f\u4e0b\uff0c\u8be5\u51fd\u6570\u5728creatElement\u51fd\u6570\u4e2d\u53ef\u80fd\u88ab\u8c03\u7528\u3002\u9501\u5b9aprops.key\u7684\u503c\u4f7f\u5f97\u65e0\u6cd5\u83b7\u53d6props.key,\u6807\u8bb0\u83b7\u53d6props\u4e2d\u7684key\u503c\u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u5f53\u4f7f\u7528props.key\u7684\u65f6\u5019\uff0c\u4f1a\u6267\u884cwarnAboutAccessingKey\u51fd\u6570\uff0c\u8fdb\u884c\u62a5\u9519\uff0c\u4ece\u800c\u83b7\u53d6\u4e0d\u5230key\u5c5e\u6027\u7684\u503c\u3002"),(0,o.kt)("p",null,"\u5373\u5982\u4e0b\u8c03\u7528\u59cb\u7ec8\u8fd4\u56deundefined:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"props.key\n")),(0,o.kt)("p",null,"\u7ed9props\u5bf9\u8c61\u5b9a\u4e49key\u5c5e\u6027\uff0c\u4ee5\u53cakey\u5c5e\u6027\u7684\u53d6\u503c\u5668\u4e3awarnAboutAccessingKey\u5bf9\u8c61\n\u8be5\u5bf9\u8c61\u4e0a\u5b58\u5728\u4e00\u4e2aisReactWarning\u4e3atrue\u7684\u6807\u5fd7\uff0c\u5728hasValidKey\u4e0a\u5c31\u662f\u901a\u8fc7isReactWarning\u6765\u5224\u65ad\u83b7\u53d6key\u662f\u5426\u5408\u6cd5\nspecialPropKeyWarningShown\u7528\u4e8e\u6807\u8bb0key\u4e0d\u5408\u6cd5\u7684\u9519\u8bef\u4fe1\u606f\u662f\u5426\u5df2\u7ecf\u663e\u793a\uff0c\u521d\u59cb\u503c\u4e3aundefined\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"function defineKeyPropWarningGetter(props, displayName) {\n  const warnAboutAccessingKey = function() {\n    if (!specialPropKeyWarningShown) {\n      specialPropKeyWarningShown = true;\n      warningWithoutStack(\n        false,\n        '%s: `key` is not a prop. Trying to access it will result ' +\n          'in `undefined` being returned. If you need to access the same ' +\n          'value within the child component, you should pass it as a different ' +\n          'prop. (https://fb.me/react-special-props)',\n        displayName,\n      );\n    }\n  };\n  warnAboutAccessingKey.isReactWarning = true;\n  Object.defineProperty(props, 'key', {\n    get: warnAboutAccessingKey,\n    configurable: true,\n  });\n}\n")),(0,o.kt)("h3",{id:"definerefpropwarninggetter"},"defineRefPropWarningGetter"),(0,o.kt)("p",null,"\u903b\u8f91\u4e0edefineKeyPropWarningGetter\u4e00\u81f4\uff0c\u9501\u5b9aprops.ref\u7684\u503c\u4f7f\u5f97\u65e0\u6cd5\u83b7\u53d6props.ref,\u6807\u8bb0\u83b7\u53d6props\u4e2d\u7684ref\u503c\u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u5f53\u4f7f\u7528props.ref\u7684\u65f6\u5019\uff0c\u4f1a\u6267\u884cwarnAboutAccessingKey\u51fd\u6570\uff0c\u8fdb\u884c\u62a5\u9519\uff0c\u4ece\u800c\u83b7\u53d6\u4e0d\u5230ref\u5c5e\u6027\u7684\u503c\u3002"),(0,o.kt)("p",null,"\u5373\u5982\u4e0b\u8c03\u7528\u59cb\u7ec8\u8fd4\u56deundefined:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"props.ref\n")),(0,o.kt)("h3",{id:"reactelement"},"ReactElement"),(0,o.kt)("p",null,"\u88abcreateElement\u51fd\u6570\u8c03\u7528\uff0c\u6839\u636e\u73af\u5883\u8bbe\u7f6e\u5bf9\u5e94\u7684\u5c5e\u6027\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u4ee3\u7801\u6027\u80fd\u4f18\u5316\uff1a\u4e3a\u63d0\u9ad8\u6d4b\u8bd5\u73af\u5883\u4e0b\uff0celement\u6bd4\u8f83\u901f\u5ea6\uff0c\u5c06element\u7684\u4e00\u4e9b\u5c5e\u6027\u914d\u7f6e\u4e3a\u4e0d\u53ef\u6570\uff0cfor...in\u8fd8\u662fObject.keys\u90fd\u65e0\u6cd5\u83b7\u53d6\u8fd9\u4e9b\u5c5e\u6027\uff0c\u63d0\u9ad8\u4e86\u901f\u5ea6\u3002")),(0,o.kt)("p",null,"\u5f00\u53d1\u73af\u5883\u6bd4\u751f\u4ea7\u73af\u5883\u591a\u4e86_store\uff0c_self\uff0c_source\u5c5e\u6027\uff0c\u5e76\u4e14props\u4ee5\u53caelement\u88ab\u51bb\u7ed3\uff0c\u65e0\u6cd5\u4fee\u6539\u914d\u7f6e\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"const ReactElement = function(type, key, ref, self, source, owner, props) {\n  const element = {\n    // This tag allows us to uniquely identify this as a React Element\n    $$typeof: REACT_ELEMENT_TYPE,\n\n    // Built-in properties that belong on the element\n    type: type,\n    key: key,\n    ref: ref,\n    props: props,\n\n    // Record the component responsible for creating this element.\n    _owner: owner,\n  };\n\n  if (__DEV__) {\n    element._store = {};\n\n    // To make comparing ReactElements easier for testing purposes, we make\n    // the validation flag non-enumerable (where possible, which should\n    // include every environment we run tests in), so the test framework\n    // ignores it.\n    Object.defineProperty(element._store, 'validated', {\n      configurable: false,\n      enumerable: false,\n      writable: true,\n      value: false,\n    });\n    // self and source are DEV only properties.\n    Object.defineProperty(element, '_self', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: self,\n    });\n    // Two elements created in two different places should be considered\n    // equal for testing purposes and therefore we hide it from enumeration.\n    Object.defineProperty(element, '_source', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: source,\n    });\n    if (Object.freeze) {\n      Object.freeze(element.props);\n      Object.freeze(element);\n    }\n  }\n\n  return element;\n};\n")),(0,o.kt)("h3",{id:"createelement"},"createElement"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u5728\u5f00\u53d1\u6a21\u5f0f\u548c\u751f\u4ea7\u6a21\u5f0f\u4e0b\uff0c\u7b2c\u4e8c\u53c2\u6570props\u4e2d\u7684ref\u4e0ekey\u5c5e\u6027\u4e0d\u4f1a\u4f20\u5165\u65b0react\u5143\u7d20\u7684props\u4e0a\uff0c\u6240\u4ee5\u5f00\u53d1\u6a21\u5f0f\u548c\u751f\u4ea7\u6a21\u5f0f\u90fd\u65e0\u6cd5\u901a\u8fc7props\u4f20\u9012ref\u4e0ekey\u3002\u751f\u4ea7\u6a21\u5f0f\u4e0bref\u4e0ekey\u4e0d\u4e3aundefined\u5c31\u8d4b\u503c\u7ed9\u65b0react\u5143\u7d20\u5bf9\u5e94\u7684ref\u4e0ekey\u5c5e\u6027\u4e0a\uff0c\u5f00\u53d1\u6a21\u5f0f\u4e0b\u83b7\u53d6ref\u4e0ekey\u662f\u5408\u6cd5\u7684\uff08\u7b2c\u4e8c\u53c2\u6570\u4e0d\u662f\u67d0\u4e2areact\u5143\u7d20\u7684props\uff0c\u5176key\u4e0eref\u5219\u4e3a\u5408\u6cd5\uff09\uff0c\u5219\u8d4b\u503c\u7ed9\u65b0react\u5143\u7d20\u5bf9\u5e94\u7684ref\u4e0ekey\u5c5e\u6027\u4e0a\u3002")),(0,o.kt)("p",null,"\u4f7f\u7528 JSX \u7f16\u5199\u7684\u4ee3\u7801\u5c06\u88ab\u8f6c\u6210\u4f7f\u7528 React.createElement() "),(0,o.kt)("p",null,"\u5728\u5229\u7528isValidElementType\u68c0\u6d4bcreateElement()\u7684\u65f6\u5019\u8fd4\u56defalse"),(0,o.kt)("p",null,"React.createElement API\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"React.createElement(\n  type,\n  [props],\n  [...children]\n)\n")),(0,o.kt)("p",null,"type(\u7c7b\u578b) \u53c2\u6570\uff1a\u53ef\u4ee5\u662f\u4e00\u4e2a\u6807\u7b7e\u540d\u5b57\u5b57\u7b26\u4e32\uff08\u4f8b\u5982 'div' \u6216'span'\uff09\uff0c\u6216\u8005\u662f\u4e00\u4e2a React \u7ec4\u4ef6 \u7c7b\u578b\uff08\u4e00\u4e2a\u7c7b\u6216\u8005\u662f\u51fd\u6570\uff09\uff0c\u6216\u8005\u4e00\u4e2a React fragment \u7c7b\u578b\u3002"),(0,o.kt)("h4",{id:"\u4ec5\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u83b7\u53d6props\u4e2d\u7684ref\u4e0ekey\u4f1a\u629b\u51fa\u9519\u8bef"},"\u4ec5\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u83b7\u53d6props\u4e2d\u7684ref\u4e0ekey\u4f1a\u629b\u51fa\u9519\u8bef"),(0,o.kt)("p",null,"props\uff1a\u5c06key\uff0cref\uff0c","_","_self\uff0c",(0,o.kt)("strong",{parentName:"p"},"source\u7684\u5c5e\u6027\u5206\u522b\u590d\u5236\u5230\u65b0react\u5143\u7d20\u7684key\uff0cref\uff0c","_","_self\uff0c"),"source\u4e0a\uff0c\u5176\u4ed6\u7684\u5c5e\u6027\u503c\uff0cassign\u5230type\u4e0a\u7684props\u4e0a\u3002",(0,o.kt)("strong",{parentName:"p"},"\u5f53\u8fd9\u4e2aprops\u662freact\u5143\u7d20\u7684props\uff0c\u90a3\u4e48\u5176ref\u4e0ekey\u662f\u65e0\u6cd5\u4f20\u5165\u65b0\u5143\u7d20\u4e0a\u7684ref\u4e0ekey\u3002\u53ea\u6709\u8fd9\u4e2aprops\u662f\u4e00\u4e2a\u65b0\u5bf9\u8c61\u7684\u65f6\u5019\u624d\u662f\u6709\u6548\u7684\u3002\u8fd9\u91cc\u5c31\u5207\u65ad\u4e86ref\u4e0ekey\u901a\u8fc7props\u7684\u4f20\u9012\u3002")),(0,o.kt)("p",null,"children\uff1a\u5f53children\u5b58\u5728\u7684\u65f6\u5019\uff0ccreateElement\u8fd4\u56de\u7684\u7ec4\u4ef6\u7684props\u4e2d\u4e0d\u4f1a\u5b58\u5728children\uff0c\u5982\u679c\u5b58\u5728\u7684\u65f6\u5019\uff0c\u8fd4\u56de\u7684\u7ec4\u4ef6\u7684props.children\u4f1a\u88ab\u4f20\u5165\u7684children\u8986\u76d6\u6389\u3002"),(0,o.kt)("h4",{id:"\u53c2\u6570\u4e2d\u7684children\u8986\u76d6\u987a\u5e8f"},"\u53c2\u6570\u4e2d\u7684children\u8986\u76d6\u987a\u5e8f"),(0,o.kt)("p",null,"\u5982\u4e0b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'//\u521b\u5efaFooter\nclass Footer extends React.Component{\n    constructor(props){\n        super(props)\n    }\n    render(){\n        return (\n            <div>\n                this is Footer {this.props.children}\n            </div>\n        )\n    }\n}\n\n//\u521b\u5efaFooterEnhance\nconst FooterEnhance = React.createElement(Footer, null ,"0000000");\n\n//\u4f7f\u7528Footer\u4e0eFooterEnhance\n<div>\n    <Footer>aaaaa</Footer>\n    {FooterEnhance}\n</div>\n')),(0,o.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"this is Footer aaaaa\nthis is Footer 0000000\n")),(0,o.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\uff1a"),(0,o.kt)("p",null,"\u7b2c\u4e09\u4e2a\u53c2\u6570children\u8986\u76d6\u6389\u539f\u6765\u7684children:aaaaa"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"\u7531\u4e0b\u9762\u6e90\u7801\u4e5f\u53ef\u77e5\u9053\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u7b2c\u4e09\u4e2a\u53c2\u6570children\u4e5f\u53ef\u4ee5\u8986\u76d6\u7b2c\u4e8c\u53c2\u6570\u4e2d\u7684children\uff0c\u6d4b\u8bd5\u5f88\u7b80\u5355\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u7b2c\u4e8c\u4e2a\u53c2\u6570props\u4e2d\u7684children\u4f1a\u8986\u76d6\u6389\u539f\u6765\u7ec4\u4ef6\u4e2d\u7684props.children")),(0,o.kt)("h4",{id:"\u8fd4\u56de\u503c\u7684\u4f7f\u7528\u5982footerenhance\u4e0d\u80fd\u5f53\u505a\u666e\u901a\u7ec4\u4ef6\u4f7f\u7528"},"\u8fd4\u56de\u503c\u7684\u4f7f\u7528\uff1a\u5982{FooterEnhance}\u3002\u4e0d\u80fd\u5f53\u505a\u666e\u901a\u7ec4\u4ef6\u4f7f\u7528\u3002"),(0,o.kt)("hr",null),(0,o.kt)("h4",{id:"\u6e90\u7801"},"\u6e90\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"const RESERVED_PROPS = {\n  key: true,\n  ref: true,\n  __self: true,\n  __source: true,\n};\n\nexport function createElement(type, config, children) {\n  let propName;\n\n  // Reserved names are extracted\n  const props = {};\n\n  let key = null;\n  let ref = null;\n  let self = null;\n  let source = null;\n\n  //\u5c06config\u4e0a\u6709\u4f46\u662fRESERVED_PROPS\u4e0a\u6ca1\u6709\u7684\u5c5e\u6027\uff0c\u6dfb\u52a0\u5230props\u4e0a\n  //\u5c06config\u4e0a\u5408\u6cd5\u7684ref\u4e0ekey\u4fdd\u5b58\u5230\u5185\u90e8\u53d8\u91cfref\u548ckey\n  if (config != null) {\n    //\u5224\u65adconfig\u662f\u5426\u5177\u6709\u5408\u6cd5\u7684ref\u4e0ekey\uff0c\u6709\u5c31\u4fdd\u5b58\u5230\u5185\u90e8\u53d8\u91cfref\u548ckey\u4e2d\n    if (hasValidRef(config)) {\n      ref = config.ref;\n    }\n    if (hasValidKey(config)) {\n      key = '' + config.key;\n    }\n\n    //\u4fdd\u5b58self\u548csource\n    self = config.__self === undefined ? null : config.__self;\n    source = config.__source === undefined ? null : config.__source;\n    // Remaining properties are added to a new props object\n    //\u5c06config\u4e0a\u7684\u5c5e\u6027\u503c\u4fdd\u5b58\u5230props\u7684propName\u5c5e\u6027\u4e0a\n    for (propName in config) {\n      if (\n        hasOwnProperty.call(config, propName) &&\n        !RESERVED_PROPS.hasOwnProperty(propName)\n      ) {\n        props[propName] = config[propName];\n      }\n    }\n  }\n\n  // Children can be more than one argument, and those are transferred onto\n  // the newly allocated props object.\n  //  \u5982\u679c\u53ea\u6709\u4e09\u4e2a\u53c2\u6570\uff0c\u5c06\u7b2c\u4e09\u4e2a\u53c2\u6570\u76f4\u63a5\u8986\u76d6\u5230props.children\u4e0a\n  //  \u5982\u679c\u4e0d\u6b62\u4e09\u4e2a\u53c2\u6570\uff0c\u5c06\u540e\u9762\u7684\u53c2\u6570\u7ec4\u6210\u4e00\u4e2a\u6570\u7ec4\uff0c\u8986\u76d6\u5230props.children\u4e0a\n  const childrenLength = arguments.length - 2;\n  if (childrenLength === 1) {\n    props.children = children;\n  } else if (childrenLength > 1) {\n    const childArray = Array(childrenLength);\n    for (let i = 0; i < childrenLength; i++) {\n      childArray[i] = arguments[i + 2];\n    }\n    if (__DEV__) {\n      if (Object.freeze) {\n        Object.freeze(childArray);\n      }\n    }\n    props.children = childArray;\n  }\n\n  // Resolve default props\n  //  \u5982\u679c\u6709\u9ed8\u8ba4\u7684props\u503c\uff0c\u90a3\u4e48\u5c06props\u4e0a\u4e3aundefined\u7684\u5c5e\u6027\u8bbe\u7f6e\u521d\u59cb\u503c\n  if (type && type.defaultProps) {\n    const defaultProps = type.defaultProps;\n    for (propName in defaultProps) {\n      if (props[propName] === undefined) {\n        props[propName] = defaultProps[propName];\n      }\n    }\n  }\n  //\u5f00\u53d1\u73af\u5883\u4e0b\n  if (__DEV__) {\n      //  \u9700\u8981\u5229\u7528defineKeyPropWarningGetter\u4e0edefineRefPropWarningGetter\u6807\u8bb0\u65b0\u7ec4\u4ef6\u4e0a\u7684props\u4e5f\u5c31\u662f\u8fd9\u91cc\u7684props\u4e0a\u7684ref\u4e0ekey\u5728\u83b7\u53d6\u5176\u503c\u5f97\u65f6\u5019\u662f\u4e0d\u5408\u6cd5\u7684\u3002\n    if (key || ref) {\n      //type\u5982\u679c\u662f\u4e2a\u51fd\u6570\u8bf4\u660e\u4e0d\u662f\u539f\u751f\u7684dom\u6807\u7b7e\uff0c\u53ef\u80fd\u662f\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d6\n      const displayName =\n        typeof type === 'function'\n          ? type.displayName || type.name || 'Unknown'\n          : type;\n      if (key) {\n        //\u5728\u5f00\u53d1\u73af\u5883\u4e0b\u6807\u8bb0\u83b7\u53d6\u65b0\u7ec4\u4ef6\u7684props.key\u662f\u4e0d\u5408\u6cd5\u7684,\u83b7\u53d6\u4e0d\u5230\u503c\n        defineKeyPropWarningGetter(props, displayName);\n      }\n      if (ref) {\n        //\u5728\u5f00\u53d1\u73af\u5883\u4e0b\u6807\u8bb0\u83b7\u53d6\u65b0\u7ec4\u4ef6\u7684props.ref\u662f\u4e0d\u5408\u6cd5\u7684,\u83b7\u53d6\u4e0d\u5230\u503c\n        defineRefPropWarningGetter(props, displayName);\n      }\n    }\n  }\n  //\u6ce8\u610f\u751f\u4ea7\u73af\u5883\u4e0b\u7684ref\u548ckey\u8fd8\u662f\u88ab\u8d4b\u503c\u5230\u7ec4\u4ef6\u4e0a\n  return ReactElement(\n    type,\n    key,\n    ref,\n    self,\n    source,\n    ReactCurrentOwner.current,\n    props,\n  );\n}\n")),(0,o.kt)("h3",{id:"createfactory"},"createFactory"),(0,o.kt)("p",null,"\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u751f\u6210\u7ed9\u5b9a\u7c7b\u578b\u7684 React \u5143\u7d20\u3002\u5728\u5229\u7528isValidElementType\u68c0\u6d4bcreateFactory()\u7684\u65f6\u5019\u8fd4\u56detrue\n\u7528\u4e8e\u5c06\u5728\u5b57\u7b26\u4e32\u6216\u8005\u51fd\u6570\u6216\u8005\u7c7b\u8f6c\u6362\u6210\u4e00\u4e2areact\u5143\u7d20\uff0c\u8be5\u5143\u7d20\u7684type\u4e3a\u5b57\u7b26\u4e32\u6216\u8005\u51fd\u6570\u6216\u8005\u7c7b\u7684\u6784\u9020\u51fd\u6570"),(0,o.kt)("p",null,"\u4f8b\u5982\uff1aFooter\u4e3a\u6587\u7ae0\u7684\u7c7b\u7ec4\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"console.log(React.createFactory('div')())\nconsole.log(React.createFactory(Footer)())\n")),(0,o.kt)("p",null,"\u8fd4\u56de\u7684\u7ed3\u679c\u5206\u522b\u4e3a\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'$$typeof:Symbol(react.element)\nkey:null\nprops:{}\nref:null\ntype:"div"\n_owner:null\n_store:{validated: false}\n_self:null\n_source:null\n')),(0,o.kt)("hr",null),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$$typeof:Symbol(react.element)\nkey:null\nprops:{}\nref:null\ntype:\u0192 Footer(props)\n_owner:null\n_store:{validated: false}\n_self:null\n_source:null\n")),(0,o.kt)("p",null,"\u6e90\u7801\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"export function createFactory(type) {\n  const factory = createElement.bind(null, type);\n  factory.type = type;\n  return factory;\n}\n")),(0,o.kt)("h3",{id:"cloneandreplacekey"},"cloneAndReplaceKey"),(0,o.kt)("p",null,"\u514b\u9686\u4e00\u4e2a\u65e7\u7684react\u5143\u7d20\uff0c\u5f97\u5230\u7684\u65b0\u7684react\u5143\u7d20\u88ab\u8bbe\u7f6e\u4e86\u65b0\u7684key"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"export function cloneAndReplaceKey(oldElement, newKey) {\n  const newElement = ReactElement(\n    oldElement.type,\n    newKey,\n    oldElement.ref,\n    oldElement._self,\n    oldElement._source,\n    oldElement._owner,\n    oldElement.props,\n  );\n\n  return newElement;\n}                                                                                   \n")),(0,o.kt)("h3",{id:"isvalidelement"},"isValidElement"),(0,o.kt)("p",null,"\u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u662f\u5408\u6cd5\u7684react\u5143\u7d20\uff0c\u5373\u5224\u65ad\u5176$$typeof\u5c5e\u6027\u662f\u5426\u4e3aREACT_ELEMENT_TYPE"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"export function isValidElement(object) {\n  return (\n    typeof object === 'object' &&\n    object !== null &&\n    object.$$typeof === REACT_ELEMENT_TYPE\n  );\n}   \n")),(0,o.kt)("h3",{id:"cloneelement"},"cloneElement"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://react.html.cn/docs/react-api.html#createelement"},"cloneElement\u5b98\u65b9API\u4ecb\u7ecd")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"React.cloneElement(\n  element,\n  [props],\n  [...children]\n)\n")),(0,o.kt)("p",null,"\u4f7f\u7528 element \u4f5c\u4e3a\u8d77\u70b9\uff0c\u514b\u9686\u5e76\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 React \u5143\u7d20\u3002 \u6240\u4ea7\u751f\u7684\u5143\u7d20\u7684props\u7531\u539f\u59cb\u5143\u7d20\u7684 props\u88ab\u65b0\u7684 props \u6d45\u5c42\u5408\u5e76\u800c\u6765\uff0c\u5e76\u4e14\u6700\u7ec8\u5408\u5e76\u540e\u7684props\u7684\u5c5e\u6027\u4e3aundefined\uff0c\u5c31\u7528element.type.defaultProps\u4e5f\u5c31\u662f\u9ed8\u8ba4props\u503c\u8fdb\u884c\u8bbe\u7f6e\u3002\u5982\u679cprops\u4e0d\u662freact\u5143\u7d20\u7684props\uff0c\u5462\u4e48props\u4e2d\u7684key \u548c ref \u5c06\u88ab\u5b58\u653e\u5728\u8fd4\u56de\u7684\u65b0\u5143\u7d20\u7684key\u4e0eref\u4e0a\u3002"),(0,o.kt)("p",null,"\u8fd4\u56de\u7684\u5143\u7d20\u76f8\u5f53\u4e8e\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"<element.type {...element.props} {...props}>{children}</element.type>\n")),(0,o.kt)("p",null,"\u5176\u6e90\u7801\u4e0ecreateElement\u7c7b\u4f3c\uff0c\u4e0d\u540c\u7684\u5730\u65b9\u662f\u5728\u5f00\u53d1\u73af\u5883\u4e0bcloneElement\u4e0d\u4f1a\u5bf9props\u8c03\u7528defineKeyPropWarningGetter\u4e0edefineRefPropWarningGetter\u5bf9props.ref\u4e0eprops.key\u8fdb\u884c\u83b7\u53d6\u62e6\u622a\u3002"),(0,o.kt)("h3",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,o.kt)("p",null,"\u5f00\u53d1\u73af\u5883\u4e0b\uff0ckey\u548cref\u4f1a\u5b58\u5728\u4e8ereact\u5143\u7d20\u7684props\u4e0a\uff0c\u4f46\u662f\u83b7\u53d6\u5230\u7684\u503c\u4e3aundefined\uff0c\u5e76\u62a5\u9519\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e0b\uff0ckey\u548cref\u4e0d\u4f1a\u5b58\u5728\u4e8ereact\u5143\u7d20\u7684props\u4e0a\u7684\u3002\nreact\u7ec4\u4ef6\u4e0a\u7684\u4f20\u9012\u7684key\u4e0eref\u53c2\u6570\u503c\u4e0d\u4f1a\u88abprops\u4f20\u9012\u7ed9\u5176\u4ed6\u7ec4\u4ef6\uff0c\u5f00\u53d1\u73af\u5883\u4e0b\u4e0e\u751f\u4ea7\u73af\u5883\u4e0b\u5904\u7406key\u548cref\u7684\u533a\u522b\uff1f"),(0,o.kt)("p",null,"creatElement\u51fd\u6570\u4e2d\u963b\u6b62ref\u3001key\u7b49\u5c5e\u6027\u8d4b\u503c\u7ed9props\uff0c\u6240\u4ee5react\u5143\u7d20\u7684key\u548cref\u4e0d\u4f1a\u5728props\u4e0a\uff0c\u5e76\u4e14\u5728\u7ec4\u4ef6\u95f4\u901a\u8fc7props\u4f20\u9012"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"for (propName in config) {\n  if (\n    hasOwnProperty.call(config, propName) &&\n    !RESERVED_PROPS.hasOwnProperty(propName)\n  ) {\n    props[propName] = config[propName];\n  }\n}\n")),(0,o.kt)("p",null,"\u5f00\u53d1\u73af\u5883\u4e0b\u4e0e\u751f\u4ea7\u73af\u5883\u4e0b\u5904\u7406key\u548cref\u7684\u533a\u522b\uff1a\u5f00\u53d1\u73af\u5883\u4e0b\u8fd8\u4f1a\u8c03\u7528defineRefPropWarningGetter\u4e0edefineKeyPropWarningGetter\uff0c\u5229\u7528Object.defineProperty\u8fdb\u884c\u62e6\u622a\u62a5\u9519\uff0c\u540c\u65f6\u5728\u751f\u4ea7\u73af\u5883\u4e0b\uff0ckey\u548cref\u4e0d\u4f1a\u5b58\u5728\u4e8ereact\u5143\u7d20\u7684props\u4e0a\u7684\u3002\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"  Object.defineProperty(props, 'key', {\n    get: warnAboutAccessingKey,\n    configurable: true,\n  });\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u4e0d\u80fd\u5c06\u4e00\u4e2areact\u5143\u7d20\u7684ref\u901a\u8fc7props\u4f20\u9012\u7ed9\u5176\u4ed6\u7ec4\u4ef6\u3002")))}d.isMDXComponent=!0}}]);